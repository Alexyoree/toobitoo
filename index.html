<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shop Login</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

  </head>
  <body>
    <div class="login-container">
      <h2>Welcome to tobitto</h2>
      <form id="loginForm">
        <label for="username">Username</label>
        <input type="text" id="username" name="username" required />

        <label for="password">Password</label>
        <div class="password-input-container">
          <input type="password" id="password" name="password" required />
          <span
            class="toggle-password"
            id="togglePassword"
            onclick="togglePasswordVisibility()"
          >
            <i class="fas fa-eye-slash"></i>
            <i class="fas fa-eye" style="display: none"></i>
          </span>
        </div>
        <label> <input type="checkbox" id="rememberMe" /> Remember me </label>
        <button type="submit">Login</button>
      </form>
      <p id="errorMessage" class="error-message"></p>
    </div>

    <div class="banner">
      <video autoplay loop muted play-inline>
        <source src="assets/yanto.mp4" type="video/mp4" />
      </video>
    </div>
    <script>
 document.addEventListener("DOMContentLoaded", (event) => {
        const storedUsername = localStorage.getItem("username");
        const storedPassword = localStorage.getItem("password");

        // Check if it's the first login (no stored username and password)
        if (storedUsername && storedPassword) {
          document.getElementById("username").value = storedUsername;

          if (localStorage.getItem("rememberMe") === "true") {
            document.getElementById("password").value = storedPassword;
            document.getElementById("rememberMe").checked = true;
          }
        }

        document
          .getElementById("loginForm")
          .addEventListener("submit", function (event) {
            event.preventDefault(); // Prevent form submission

            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;
            const rememberMe = document.getElementById("rememberMe").checked;

            if (!storedUsername && !storedPassword) {
              // First time login, store the username and password
              localStorage.setItem("username", username);
              localStorage.setItem("password", password);

              if (rememberMe) {
                localStorage.setItem("rememberMe", true);
              }

              window.location.href = "login.html";
            } else {
     
              if (username === storedUsername && password === storedPassword) {
                if (rememberMe) {
                  localStorage.setItem("username", username);
                  localStorage.setItem("password", password);
                  localStorage.setItem("rememberMe", true);
                } else {
                  localStorage.removeItem("password");
                  localStorage.removeItem("rememberMe");
                }

                window.location.href = "login.html";
              } else {
                document.getElementById("errorMessage").textContent =
                  "Incorrect username or password";
              }
            }
          });
      });

      function togglePasswordVisibility() {
        const passwordInput = document.getElementById("password");
        const toggleBtn = document.getElementById("togglePassword");

        if (passwordInput.type === "password") {
          passwordInput.type = "text";
          toggleBtn.querySelector(".fa-eye-slash").style.display = "none";
          toggleBtn.querySelector(".fa-eye").style.display = "inline";
        } else {
          passwordInput.type = "password";
          toggleBtn.querySelector(".fa-eye-slash").style.display = "inline";
          toggleBtn.querySelector(".fa-eye").style.display = "none";
        }
      }
    </script>
  </body>
</html>
